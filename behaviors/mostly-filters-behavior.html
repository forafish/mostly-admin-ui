<script>
  var Mostly = Mostly || {};

  /**
   * `Mostly.FilterBehavior` provides a set of helpers to use in filter expressions.
   *
   * @polymerBehavior
   */
  Mostly.FiltersBehavior = {

    /**
     * Checks if the document is a favorite.
     */
    isFavorite: function(doc) {
      return doc && doc.metadata && doc.metadata.favorites &&
        doc.metadata.favorites.isFavorite;
    },

    /**
     * Checks if the current user is subscribed to document notifications.
     */
    isSubscribed: function(doc) {
      return doc && doc.metadata && doc.metadata.subscribedNotifications &&
        doc.metadata.subscribedNotifications.length > 0;
    },

    /**
     * Checks if the document can be added to a collection.
     */
    isCollectionMember: function(doc) {
      return (doc) ? doc.metadata.facets.indexOf('NotCollectionMember') === -1 : false;
    },

    /**
     * Checks if the document is a version.
     */
    isVersion: function(doc) {
      return doc && doc.isVersion;
    },

    /**
     * Checks if the document is immutable.
     */
    isImmutable: function(doc) {
      return this.hasFacet(doc, 'Immutable');
    },

    /**
     * Checks the document's type.
     */
    hasType: function(doc, type) {
      return doc && doc.type === type;
    },

    /**
     * Checks if the document is a proxy.
     */
    isProxy: function(doc) {
      return doc && doc.isProxy;
    },

    /**
     * Checks if the document's path matches the given string regexp.
     */
    pathMatches: function(doc, regex) {
      return doc && doc.path && new RegExp(regex).test(regex);
    },

    /**
     * Checks if the document's path starts with the given path.
     */
    pathStartsWith: function(doc, path) {
      return this.pathMatches(doc, '^' + path);
    },

    /**
     * Checks the document's life cycle state..
     */
    hasState: function(doc, state) {
      return doc && doc.state === state;
    },


    /**
     * Checks if the document has the given facet.
     */
    hasFacet: function(doc, facet) {
      return doc && doc.metadata.facets && doc.metadata.facets.indexOf(facet) !== -1;
    },

    /**
     * Checks if the document has the given permission.
     */
    hasPermission: function(doc, permission) {
      return doc && doc.metadata && doc.metadata.permissions &&
          doc.metadata.permissions.indexOf(permission) !== -1;
    },

    /**
     * Checks if the document has a main blob.
     */
    hasContent: function(doc) {
      return doc && doc.file;
    },

    /**
     * Checks if the document has attachments.
     */
    hasAttachments: function(doc) {
      return doc && doc.files && doc.files.length > 0;
    },

    /**
     * Checks if the document has attachments.
     */
    hasVersions: function(doc) {
      return doc && doc.version;
    },

    /**
     * Checks if the document belongs to a collection.
     */
    hasCollections: function(doc) {
      return doc && doc.metadata && doc.metadata.collections &&
          doc.metadata.collections.length > 0;
    },

    /**
     * Checks if given user is member of the group.
     */
    isMember: function(user, group) {
      return user && user.groups && user.groups.indexOf(group) !== -1;
    }

  };
</script>
